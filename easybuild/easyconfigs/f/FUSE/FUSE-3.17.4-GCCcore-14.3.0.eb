easyblock = 'MesonNinja'

name = 'FUSE'
version = '3.17.4'

homepage = 'https://github.com/libfuse/libfuse'
description = "The reference implementation of the Linux FUSE (Filesystem in Userspace) interface"

toolchain = {'name': 'GCCcore', 'version': '14.3.0'}

source_urls = ['https://github.com/libfuse/libfuse/archive/']
sources = ['fuse-%(version)s.tar.gz']
checksums = ['dd21d1545c05e73ada594b93fe593351b7dbf10940fd93b934b9395513108b34']

builddependencies = [
    ('Meson', '1.8.2'),
    ('Ninja', '1.13.0'),
    ('binutils', '2.44'),
]

# avoid that root permissions are required when installing utils (like fusermount)
configopts = "-Dinitscriptdir=%(installdir)s/etc/init.d -Dudevrulesdir=%(installdir)s/udev/rules.d -Duseroot=false"

sanity_check_paths = {
    'files': ['bin/fusermount3', 'etc/fuse.conf', 'lib/libfuse%%(version_major)s.%s' % SHLIB_EXT,
              'lib/pkgconfig/fuse%(version_major)s.pc'],
    'dirs': ['include/fuse%(version_major)s', 'share/man'],
}

sanity_check_commands = ["fusermount3 -h | grep '^fusermount3'"]

moduleclass = 'lib'
